{"version":3,"file":"wavesurfer.playhead.js","mappings":"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","sources":["webpack://WaveSurfer/webpack/universalModuleDefinition","webpack://WaveSurfer/./src/plugin/playhead/index.js","webpack://WaveSurfer/webpack/bootstrap","webpack://WaveSurfer/webpack/before-startup","webpack://WaveSurfer/webpack/startup","webpack://WaveSurfer/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WaveSurfer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WaveSurfer\"] = factory();\n\telse\n\t\troot[\"WaveSurfer\"] = root[\"WaveSurfer\"] || {}, root[\"WaveSurfer\"][\"playhead\"] = factory();\n})(self, () => {\nreturn ","\n/**\n * The playhead plugin separates the notion of the currently playing position from\n * a 'play-start' position.  Having a playhead enables a listening pattern\n * (commonly found in DAWs) that involves listening to a section of a track\n * repeatedly, rather than listening to an entire track in a linear fashion.\n *\n * @implements {PluginClass}\n *\n * @example\n * import PlayheadPlugin from 'wavesurfer.playhead.js';\n *\n * // if you are using <script> tags\n * var PlayheadPlugin = window.WaveSurfer.playhead;\n *\n * // ... initialising wavesurfer with the plugin\n * var wavesurfer = WaveSurfer.create({\n *   // wavesurfer options ...\n *   plugins: [\n *     PlayheadPlugin.create({\n *        movePlayheadOnSeek: true,\n *        drawPlayhead: false,\n *        movePlayheadOnPause: false\n *     })\n *   ]\n * });\n */\n\nconst DEFAULT_FILL_COLOR = '#CF2F00';\n\nexport default class PlayheadPlugin {\n    /**\n     * @typedef {Object} PlayheadPluginParams\n     * @property {?boolean} draw=true Draw the playhead as a triangle/line\n     * @property {?boolean} moveOnSeek=true Seeking (via clicking) while playing moves the playhead\n     * @property {?boolean} returnOnPause=true Pausing the track returns the seek position to the playhead\n     */\n\n    /**\n     * Playhead plugin definition factory\n     *\n     * This function must be used to create a plugin definition which can be\n     * used by wavesurfer to correctly instantiate the plugin.\n     *\n     * @param {PlayheadPluginParams} params parameters use to initialise the plugin\n     * @since 5.0.0\n     * @return {PluginDefinition} an object representing the plugin\n     */\n    static create(params) {\n        return {\n            name: 'playhead',\n            deferInit: params && params.deferInit ? params.deferInit : false,\n            params: params,\n            instance: PlayheadPlugin\n        };\n    }\n\n    constructor(params, ws) {\n        this.params = params;\n        this.options = {};\n\n        ['draw', 'moveOnSeek', 'returnOnPause'].forEach(opt => {\n            if (opt in params) {\n                this.options[opt] = params[opt];\n            } else {\n                this.options[opt] = true;\n            }\n        });\n\n\n        this.wavesurfer = ws;\n        this.util = ws.util;\n        this.style = this.util.style;\n        this.markerWidth = 21;\n        this.markerHeight = 16;\n        this.playheadTime = 0;\n        this.unFuns = [];\n\n        this._onResize = () => {\n            this._updatePlayheadPosition();\n        };\n\n        this._onReady = () => {\n            this.wrapper = this.wavesurfer.drawer.wrapper;\n            this._updatePlayheadPosition();\n        };\n    }\n\n    _onBackendCreated() {\n        this.wrapper = this.wavesurfer.drawer.wrapper;\n\n        if (this.options.draw) {\n            this._createPlayheadElement();\n            window.addEventListener('resize', this._onResize, true);\n            window.addEventListener('orientationchange', this._onResize, true);\n\n            this.wavesurferOn('zoom', this._onResize);\n        }\n\n        this.wavesurferOn('pause', () => {\n            if ( this.options.returnOnPause ) {\n                this.wavesurfer.setCurrentTime(this.playheadTime);\n            }\n        });\n\n        this.wavesurferOn('seek', () => {\n            if ( this.options.moveOnSeek ) {\n                this.playheadTime = this.wavesurfer.getCurrentTime();\n                this._updatePlayheadPosition();\n            }\n        });\n\n        this.playheadTime = this.wavesurfer.getCurrentTime();\n    }\n\n    wavesurferOn(ev, fn) {\n        let ret = this.wavesurfer.on(ev, fn);\n        this.unFuns.push(() => {\n            this.wavesurfer.un(ev, fn);\n        });\n        return ret;\n    }\n\n    init() {\n        if (this.wavesurfer.isReady) {\n            this._onBackendCreated();\n            this._onReady();\n        } else {\n            let r;\n\n            this.wavesurfer.once('ready', () => this._onReady());\n            this.wavesurfer.once('backend-created', () => this._onBackendCreated());\n        }\n    }\n\n    destroy() {\n        this.unFuns.forEach(f => f());\n        this.unFuns = [];\n\n        this.wrapper.removeChild(this.element);\n\n        window.removeEventListener('resize', this._onResize, true);\n        window.removeEventListener('orientationchange', this._onResize, true);\n    }\n\n    setPlayheadTime(time) {\n        this.playheadTime = time;\n\n        if (!this.wavesurfer.isPlaying()) {\n            this.wavesurfer.setCurrentTime(time);\n        }\n        this._updatePlayheadPosition();\n    }\n\n    _createPointerSVG() {\n        const svgNS = 'http://www.w3.org/2000/svg';\n\n        const el = document.createElementNS(svgNS, 'svg');\n        const path = document.createElementNS(svgNS, 'path');\n\n        el.setAttribute('viewBox', '0 0 33 30');\n        path.setAttribute('d', 'M16.75 31 31.705 5.566A3 3 0 0 0 29.146 1H4.354a3 3 0 0 0-2.56 4.566L16.75 31z');\n        path.setAttribute('stroke', '#979797');\n        path.setAttribute('fill', DEFAULT_FILL_COLOR);\n\n        el.appendChild(path);\n\n        this.style(el, {\n            width: this.markerWidth + 'px',\n            height: this.markerHeight + 'px',\n            cursor: 'pointer',\n            'z-index': 5\n        });\n        return el;\n    }\n\n    _createPlayheadElement() {\n        const el = document.createElement('playhead');\n        el.className = 'wavesurfer-playhead';\n\n        this.style(el, {\n            position: 'absolute',\n            height: '100%',\n            display: 'flex',\n            'flex-direction': 'column'\n        });\n\n        const pointer = this._createPointerSVG();\n        el.appendChild(pointer);\n\n        pointer.addEventListener('click', e => {\n            e.stopPropagation();\n            this.wavesurfer.setCurrentTime(this.playheadTime);\n        });\n\n        const line = document.createElement('div');\n        this.style(line, {\n            'flex-grow': 1,\n            'margin-left': (this.markerWidth / 2 - 0.5) + 'px',\n            background: 'black',\n            width: '1px',\n            opacity: 0.1\n        });\n\n        el.appendChild(line);\n\n        this.element = el;\n        this.wrapper.appendChild(el);\n    }\n\n    _updatePlayheadPosition() {\n        if (!this.element) {\n            return;\n        }\n\n        const duration = this.wavesurfer.getDuration();\n        const elementWidth =\n            this.wavesurfer.drawer.width /\n            this.wavesurfer.params.pixelRatio;\n\n        const positionPct = this.playheadTime / duration;\n        this.style(this.element, {\n            left: ((elementWidth * positionPct) - (this.markerWidth / 2)) + 'px'\n        });\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/plugin/playhead/index.js\");\n",""],"names":["DEFAULT_FILL_COLOR","PlayheadPlugin","params","ws","_this","_classCallCheck","options","forEach","opt","wavesurfer","util","style","markerWidth","markerHeight","playheadTime","unFuns","_onResize","_updatePlayheadPosition","_onReady","wrapper","drawer","_createClass","key","value","_onBackendCreated","_this2","draw","_createPlayheadElement","window","addEventListener","wavesurferOn","returnOnPause","setCurrentTime","moveOnSeek","getCurrentTime","ev","fn","_this3","ret","on","push","un","init","_this4","isReady","r","once","destroy","f","removeChild","element","removeEventListener","setPlayheadTime","time","isPlaying","_createPointerSVG","svgNS","el","document","createElementNS","path","setAttribute","appendChild","width","height","cursor","_this5","createElement","className","position","display","pointer","e","stopPropagation","line","background","opacity","duration","getDuration","elementWidth","pixelRatio","positionPct","left","create","name","deferInit","instance","exports","default","module"],"sourceRoot":""}